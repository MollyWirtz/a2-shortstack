<!doctype html>
<html lang="en">

<head>
  <title>CS4241 Assignment 2</title>
  <meta charset="utf-8">
</head>

<body>
  <h1>Bill Tracker</h1>
  <h3>Enter your bill:</h3>
  <form name="billForm" action="">
    <input type="text" id="name" value="Bill name">
    <input type="number" id="amt" value="0.00">
    <input type="date" id="date">
    <input type="checkbox" id="paid" value="true">
    <label for="paid">Paid?</label>
    <button>submit</button>
  </form>

  <!-- Results functionality to show entire dataset -->
  <br>
  <button onClick="showAllBills()">Show all bills</button>
  <br>
  Select an entry to modify
</body>
<script>
  const submit = function (e) {
    // prevent default form action from being carried out
    e.preventDefault()

    var computePaid = document.getElementById("paid").checked;

    const input = document.querySelector('billForm'),
      json = {
        billName: document.querySelector('#name').value,
        billAmt: document.querySelector('#amt').value,
        billDate: document.querySelector('#date').value,
        billPay: computePaid
      },

      body = JSON.stringify(json)

    fetch('/submit', {
        method: 'POST',
        body
      })
      .then(function (response) {
        // do something with the reponse 
        console.log(response)
      })
    return false
  }

  window.onload = function () {
    const button = document.querySelector('button')
    button.onclick = submit
  }

  // 
  function showAllBills() {
    const response = fetch('/results', {
        method: 'GET'
      })
      .then(function (response) {
        response.text().then(function (text) {
          console.log(text)
        })
      })
  }
</script>

</html>